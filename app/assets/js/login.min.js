var login=(function(){var a,h,p,r,s,c,l,g;function k(t){a=t.mediator||app.trigger;h=t.wrapper||$(".login-wrapper");p=t.usernameElement||h.find(".username");r=t.passwordElement||h.find(".password");s=t.rememberMeElement||h.find(".remember-me");c=t.failMsgElement||h.find(".fail-msg");l=t.submitElement||h.find(".submit");g=t.logoutElement||$(".logout");f()}function f(){l.on("click",function(){var t=b();a("login-submit",t)});h.find("input").on("keypress",function(u){if(u.which==13){var t=b();a("login-submit",t)}});g.on("click",function(){a("logout")})}function q(){h.show();p.focus()}function e(){h.hide()}function m(){if(window.localStorage.logged||window.sessionStorage.logged){if(!window.sessionStorage.logged){sessionStorage.clear();d()}return true}else{return false}}function d(){for(var t in window.localStorage){if(!window.localStorage.hasOwnProperty(t)){continue}window.sessionStorage[t]=window.localStorage[t]}}function n(){localStorage.clear();sessionStorage.clear()}function o(t){if(t.rememberMe){window.localStorage.logged=true;window.localStorage.token=t.token}window.sessionStorage.logged=true;window.sessionStorage.token=t.token;a("login-finished")}function b(){return{username:p.val(),password:r.val(),rememberMe:s.prop("checked")}}function i(){p.val("");r.val("");c.hide().text("")}function j(t){c.show().html('<i class="fa fa-lg fa-exclamation" aria-hidden="true"></i> '+t.error)}return{init:k,show:q,hide:e,isLogged:m,logout:n,storeToken:o,resetLoginForm:i,authFailed:j}})();